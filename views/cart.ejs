<!DOCTYPE html>
<html>
<head></head>
    <title>購物車</title>
</head>
<% include header %>
<body>
    <div id="wrapper">
        <div id="page">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">購物車清單</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            
                        </div>
                        <!-- /.panel-heading -->
                            <input type="hidden" id="product" name="productId" />
                            <div class="panel-body">
                                <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr>
                                            <th>品名</th>
                                            <th>售價</th>
                                            <th>購買數量</th>
                                            <th>更改購買數量</th>
                                            <th>合計金額</th>
                                            <th>刪除產品</th>
                                        </tr>
                                    </thead>
                                    <form action="/deleteproduct" method="GET">
                                    <% if (loginStatus == false) { %>
                                        <tbody>
                                        <% for(var i=0 ; i < data.length;i++) { %>
                                            <tr class="odd gradeX">
                                                <td>
                                                    <%=data[i].product_name %>
                                                </td>
                                                <td>
                                                    <%=data[i].price %>
                                                </td>
                                                <td class="ammount">
                                                    <%=data[i].amount %>
                                                </td>
                                                <td>
                                                    <button class="add" onclick="add(<%=data[i].PRODUCT_AMOUNT %>)">+</button>
                                                    <button class="cut" onclick="cut(<%=data[i].PRODUCT_AMOUNT %>)">-</button>
                                                </td>
                                                <td class="subtotal">
                                                    <%=data[i].subtotal %>                                                    
                                                </td>
                                                <td>
                                                    <button type="submit" onclick="deleteProduct(<%=data[i].id %>)">刪除</button>
                                                </td>
                                            </tr>
                                        <% } %>
                                    <% } %>
                                    </tbody>
                                    </form>
                                </table>
                                <form action="/product/check" method="POST">
                                   <div><span id="total">總價：</span></div>
                                    <button type="submit" id="check">進入結帳</button> 
                                </form>
                                
                                <!-- /.table-responsive -->
                            </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <script>
                $(function () {

                
                // function addToCart(productId) {
                //     $("#product").val(productId);
                // }
                // var subtotal = 
                var subPriceValue = $('.subtotal');
                var subPriceString = subPriceValue.textContent;
                var subPrice = new Array(subPriceString);
                    console.log(subPriceString);   
                
                // for (var i = 0; i < subPriceValue.length; i++) {
                //     var subPriceString = subPriceValue[i].textContent;
                //     // var subPriceInt = parseInt(subPriceString);
                //     var subPrice = new Array(subPriceString.length);
                //     subPrice[i] = subPriceString[i];
                //     var total = 0;
                //     console.log(subPriceString);   
                // }    
                    
                    // console.log(subPriceInt);
                    // for(var i = 0; i < subPrice.length; i++){
                    //     total += subPrice[i];
                    //     console.log(total);   
                    // }   
                

                function priceTotal(subtotal) {
                    for (var i = 0; i < subtotal.length; i++) {
                        var subtotal = new Array('.subtotal');
                        total += subtotal;
                    }
                    return 
                    console.log("total" + total);
                }
                // function priceTotal(subtotal){
                //     var subtotal = $('.subtotal');
                //     var total = 0;
                //     for(var i=0 ;i < subtotal.length;i++){
                //      total += subtotal;   
                //     }

                // }

                // Array.prototype.sum = function () {
                //         return this.reduce(function (partial, value) {
                //             return partial + value;
                //         })
                //     };
                //     [1, 4, 7, 2, 10].sum(); // 24

                function add(PRODUCT_AMOUNT){
                    var ammount = $('.ammount');
                    this.ammount = ammount + 1;
                    console.log(ammount);
                }
                function cut(PRODUCT_AMOUNT) {
                    var ammount = $('.ammount');
                    this.ammount = ammount - 1;
                    console.log(ammount);
                }
                priceTotal();
                });
            </script>
    </main>
</body>
</html>