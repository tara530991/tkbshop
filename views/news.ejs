<!DOCTYPE html>
<html lang="en">
<head>
    <title>最新消息</title>
</head>
<% include header %>
<body>
    <div id="wrapper">
        <div id="page">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">最新消息列表</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row wrap1280">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            DataTables Advanced Tables
                        </div>
                        <!-- /.panel-heading -->
                        <div id="panBody" class="panel-body">
                            <table id="news_list" width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                                <div>
                                    <span>排序方式</span>
                                    <select name="sort" id="sort" onchange="sortSearch()">
                                        <option value="">請選擇條件</option>
                                        <option value="1">時間(由新至舊)</option>
                                        <option value="2">時間(由舊至新)</option>
                                    </select>
                                </div>
                                <div>
                                    <input type="text" name="search" id="search">
                                    <input type="button" value="查詢" onclick="sortSearch()">
                                </div>
                                <thead>
                                    <tr>
                                        <th>日期</th>
                                        <th>標題</th>
                                        <th>圖片</th>
                                        <th>內容</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% for(var i=0 ; i < data.length;i++) { %>
                                        <tr class="odd gradeX">
                                            <td>
                                                <%=moment(data[i].date).format('YYYY-MM-DD')%>
                                            </td>
                                            <td>
                                                <%=data[i].title %>
                                            </td>
                                            <td>
                                                <img src="<%=data[i].pic %>" alt="">
                                            </td>
                                            <td>
                                                <%=data[i].content %>
                                            </td>
                                        </tr>
                                        <%} %>
                                </tbody>
                            </table>
                            <!-- /.table-responsive -->
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
    <script>
        $(function(){
            
        })

        function sortSearch(){
            $.ajax({
                url:'ajaxNews',
                method: 'GET',
                dataType: 'text',
                data:{
                    sort: $('#sort').val(),
                    search: $('#search').val(),
                },
                success:function(data){
                    $('#news_list').remove();
                    $('#panBody').append(data);
                },
                error:function(err){
                    console.log(err);
                }
            })  
        }
    </script>
</body>
</html>